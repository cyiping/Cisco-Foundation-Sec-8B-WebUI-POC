# Models as Malware: Attacking and Defending the AI Supply Chain

This workshop was originally presented at BlackHat Europe 2025 and has been uploaded here for posterity.

**The original presentation slides are available at [public/slides.pdf](public/slides.pdf).**

![Presentation abstract](public/abstract.png)

> The open source model development community is growing exponentially, with over 1.8 million publicly accessible models on HuggingFace today.
>
> Institutions and individuals alike leverage this platform to access and share state-of-the-art AI for deployment on a wide range of infrastructure, from personal devices to production systems.
>
> Under the hood, many AI model formats are both data (weights) and code (architecture), with most users relying on easy but vulnerable serialization formats to distribute models â€” and attackers are taking notice, embedding payloads in models to connect to C2 servers:
> - <https://thehackernews.com/2025/02/malicious-ml-models-found-on-hugging.html> (Feb 2025)
> - <https://arstechnica.com/security/2024/03/hugging-face-the-github-of-ai-hosted-code-that-backdoored-user-devices/> (Mar 2024)
>
> In this session, you'll learn 1) how to instrument and detect malicious payloads in AI models and 2) how recent enhancements to ClamAV are protecting customers from supply chain compromises in the era of AI.
>
> Working understanding of Python programming is expected.

## Prerequisites

### 1 - ClamAV

Install ClamAV:

- <https://docs.clamav.net/manual/Installing.html>
- <https://docs.clamav.net/manual/Usage/Configuration.html#unix>

#### Linux

Follow the instructions for your distro here: <https://docs.clamav.net/manual/Installing.html#linux-deb-rpm>

#### macOS

Recommended method:

```shell
brew install clamav

# Setup config files (need to comment out the string "Example" as part of setup)
clamconf -g freshclam.conf > /opt/homebrew/etc/clamav/freshclam.conf
sed -i '' 's/Example/#Example/g' /opt/homebrew/etc/clamav/freshclam.conf
# Uncomment to enable the default signature database mirror
sed -i '' 's/#DatabaseMirror/DatabaseMirror/g' /opt/homebrew/etc/clamav/freshclam.conf

clamconf -g clamd.conf > /opt/homebrew/etc/clamav/clamd.conf
sed -i '' 's/Example/#Example/g' /opt/homebrew/etc/clamav/clamd.conf

clamconf -g clamav-milter.conf > /opt/homebrew/etc/clamav/clamav-milter.conf
sed -i '' 's/Example/#Example/g' /opt/homebrew/etc/clamav/clamav-milter.conf

freshclam
```

### 2 - Demo Environment

Install the demo prerequisites:

```shell
uv venv
source .venv/bin/activate
uv pip install -r requirements.txt
.venv/bin/jupyter notebook
```

Then open the **[Workshop Notebook](Workshop.ipynb)**!
